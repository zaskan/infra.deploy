---
# - name: Create a category
#   community.vmware.vmware_category:
#     category_name: "{{ category }}"
#     category_description: "{{ category_description }}"
#     category_cardinality: 'multiple'
#     validate_certs: false
#     state: present

# - name: Create tag
#   community.vmware.vmware_tag:
#     tag_name: "{{ item }}"
#     category_name: "{{ category }}"
#     state: present
#     validate_certs: false
#   loop: "{{ tags }}"

- name: Deploy Virtual Machines
  ansible.builtin.include_tasks: provision.yml

- name: Add tags to the virtual machine
  community.vmware.vmware_tag_manager:
    tag_names: "{{ add_tag }}"
    object_name: "{{ item.vm_name }}"
    object_type: VirtualMachine
    state: add
    validate_certs: false
  loop_control:
    loop_var: add_tag
  loop: "{{ item.add_tags }}"

